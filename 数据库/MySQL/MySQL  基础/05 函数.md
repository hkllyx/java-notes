- [数值函数](#数值函数)
- [字符串函数](#字符串函数)
- [日期和时间函数](#日期和时间函数)
- [JSON 函数](#json-函数)
- [条件判断函数](#条件判断函数)
- [系统信息函数](#系统信息函数)
- [加密函数](#加密函数)
- [格式化函数](#格式化函数)
- [改变字符集的函数](#改变字符集的函数)
- [转换数据类型](#转换数据类型)
- [加锁函数和解锁函数](#加锁函数和解锁函数)
- [重复执行指定操作的函数](#重复执行指定操作的函数)

# 数值函数

数值函数主要用于处理数字，包括整型、浮点数等。

| 函数                       | 功能                                                   |
| -------------------------- | ------------------------------------------------------ |
| `ABS(x)`                   | 返回 x 的绝对值                                        |
| `MOD(x, y)`                | 取模：x 除以 y 的余数                                  |
| `CEIL(x)`, `CEILING(x)`    | 返回大于或等于 x 的最小整数                            |
| `FLOOR(x)`                 | 返回小于或等于 x 的最大整数                            |
| `RAND()`                   | 返回 [0, 1) 之间的随机数                               |
| `RAND(x)`                  | 返回 [0, 1) 的随机数，x 值相同时返回的随机数相同       |
| `SIGN(x)`                  | 返回 x 的符号。负数、0、正数分别返回 - 1、0、1         |
| `PI()`                     | 返回圆周率 (3.141593）                                 |
| `ROUND(x)`                 | 返回离 x 最近的整数                                    |
| `ROUND(x, y)`              | 返回 x 保留到小数点后 y 位的值，进行四舍五入           |
| `TRUNCATE(x, y)`           | 返回 x 保留到小数点后 y 位的值，不进行四舍五入（截断） |
| `POW(x, y)`, `POWER(x, y)` | 返回 x 的 y 次方                                       |
| `SQRT(x)`                  | 返回 x 的平方根                                        |
| `EXP(x)`                   | 返回 e 的 x 次方                                       |
| `MOD(x, y)`                | 返回 x 除以 y 以后的余数                               |
| `LOG(x)`                   | 返回自然对数                                           |
| `LOG10(x)`                 | 返回以 10 为底的对数                                   |
| `RADIANS(x)`               | 将角度转换为弧度                                       |
| `DEGREES(x)`               | 将弧度转换为角度                                       |
| `SIN(x)`                   | 求正弦值 (参数是弧度)                                  |
| `ASIN(x)`                  | 求反正弦值 (参数是弧度)                                |
| `COS(x)`                   | 求余弦值 (参数是弧度)                                  |
| `ACOS(x)`                  | 求反余弦值 (参数是弧度)                                |
| `TAN(x)`                   | 求正切值 (参数是弧度)                                  |
| `ATAN(x)`, `ATAN2(x)`      | 求反正切值 (参数是弧度)                                |
| `COT(x)`                   | 求余切值 (参数是弧度)                                  |
| `BIN(x)`                   | 返回 x 的二进制                                        |
| `HEX(x)`                   | 返回 x 的十六进制                                      |
| `OCT(x)`                   | 返回 x 的八进制                                        |
| `CONV(x, f1, f2)`          | 返回 f1 进制数变成 f2 进制数                           |

# 字符串函数

字符串函数是 MySQL 中最常用的一类函数，字符串函数主要用于处理表中的字符串。

注意：在 MySQL 中，字符串的字符索引从 1 开始，即字符串中第一个字符的索引为 1 而不是 0。

| 函数                                         | 功能                                                    |
| -------------------------------------------- | ------------------------------------------------------- |
| `CHAR_LENGTH(s)`                             | 返回字符串 s 的字符数                                   |
| `LENGTH(s)`                                  | 返回字符串 s 的长度                                     |
| `CONCAT(s1, s2, ...)`                        | 将字符串 s1, s2 等多个字符串拼接成一个字符串            |
| `CONCAT_WS(s, s1, s2, ...)`                  | 同 `CONCAT (s1, s2, ...)`，但是每两个字符串间要加上 s   |
| `INSERT(s, off, len, rep)`                   | 将字符串 rep 替换 s 的 off 位置开始长度为 len 的字符串  |
| `UPPER(s)`, `UCAASE(s)`                      | 将字符串 s 的所有字母变成大写字母                       |
| `LOWER(s)`, `LCASE(s)`                       | 将字符串 s 的所有字母变成小写字母                       |
| `LEFT(s, n)`                                 | 返回字符串 s 的前 n 个字符                              |
| `RIGHT(s, n)`                                | 返回字符串 s 的后 n 个字符                              |
| `LPAD(s, len, pad)`                          | 用字符串 pad 来填充 s 的开始处，使字符串长度达到 len    |
| `RPAD(s, len, pad)`                          | 用字符串 pad 来填充 s 的结尾处，使字符串的长度达到 len  |
| `TRIM(s)`                                    | 去掉字符串 s 两端的空格                                 |
| `TRIM(tar FROM s)`                           | 去掉字符串 s 两端的字符串 tar                           |
| `LTRIM(s)`                                   | 去掉字符串 s 左端的空格                                 |
| `RTRIM(s)`                                   | 去掉字符串 s 右端的空格                                 |
| `REPEAT(s, n)`                               | 将字符串 s 重复 n 次                                    |
| `SPACE(n)`                                   | 返回 n 个空格                                           |
| `REPLACE(s, tar, rep)`                       | 将字符串 rep 替代字符串 s 中的字符串 tar                |
| `STRCMP(s1, s2)`                             | 比较字符串 s1 和 s2。s1 > s2 返回 -1                    |
| `SUBSTRING(s, off, len)`, `MID(s, off, len)` | 获取从字符串 s 中的第 off 个位置开始长度为 len 的字符串 |
| `LOCATE(t, s)`, `POSITION(t IN s)`           | 从字符串 s 中获取 t 的开始位置                          |
| `INSTR(s, t)`                                | 从字符串 s 中获取 t 的开始位置                          |
| `REVERSE(s)`                                 | 将字符串 s 的顺序反过来                                 |
| `ELT(n, s1, s2, ...)`                        | 返回第 n 个字符串                                       |
| `FIELD(t, s1, s2, ...)`                      | 返回第一个与字符串 t 匹配的字符串位置                   |
| `FIND_IN_SET(t, s)`                          | 返回在字符串 s 中与 t 匹配的字符串的位置                |
| `ASCII(s)`                                   | 返回字符串 s 的第一个字符的 ASCII 码                    |

# 日期和时间函数

| 函数                                                                           | 功能                                                      |
| ------------------------------------------------------------------------------ | --------------------------------------------------------- |
| `CURDATE()`, `CURRENT_DATE()`                                                  | 返回当前日期                                              |
| `CURTIME()`, `CURRENT_TIME()`                                                  | 返回当前时间                                              |
| `NOW()`, `CURRENT_TIMESTAMP()`, `LOCALTIME()`, `SYSDATE()`, `LOCALTIMESTAMP()` | 返回当前日期和时间                                        |
| `UNIX_TIMESTAMP()`                                                             | 以 UNIX 时间戳的形式返回当前时间                          |
| `UNIX_TIMESTAMP(d)`                                                            | 将时间 d 以 UNIX 时间戳的形式返回                         |
| `FROM_UNIXTIME(d)`                                                             | 将 UNIX 时间戳的时间转换为普通格式的时间                  |
| `UTC_DATE()`                                                                   | 返回 UTC 日期                                             |
| `UTC_TIME()`                                                                   | 返回 UTC 时间                                             |
| `MONTH(d)`                                                                     | 计算日期 d 是几月。返回 [1, 12]，1 表示一月               |
| `MONTHNAME(d)`                                                                 | 计算日期 d 是几月，返回 Janyary, Febrary 等               |
| `DAYOFWEEK(d)`                                                                 | 计算日期 d 是周几。返回 [1, 7]，1 表示周日                |
| `DAYNAME(d)`                                                                   | 计算日期 d 是周几。返回 Monday, Tuesday 等                |
| `WEEKDAY(d)`                                                                   | 计算日期 d 是周几。返回 [0, 6]，0 表示周日                |
| `WEEK(d)`, `WEEKOFYEAR(d)`                                                     | 计算日期 d 是本年的第几周。[0, 52]                        |
| `DAYOFYEAR(d)`                                                                 | 计算日期 d 是本年的第几天。[1, 366]                       |
| `DAYOFMONTH(d)`                                                                | 计算日期 d 是本月的第几天。[1, 31]                        |
| `QUARTER(d)`                                                                   | 返回日期 d 是第几季节。[1, 4]                             |
| `HOUR(t)`                                                                      | 返回 t 中的小时值                                         |
| `MINUTE(t)`                                                                    | 返回 t 中的分钟值                                         |
| `SECOND(t)`                                                                    | 返回 t 中的秒钟值                                         |
| `TIME_TO_SEC(t)`                                                               | 将时间 t 转换为秒。[0, 86399]                             |
| `SEC_TO_TIME(s)`                                                               | 将以秒为单位的时间 s 转换为时分秒的格式                   |
| `EXTRACT(type FROM d)`                                                         | 从日期 d 中获取指定的值，type 指定返回值的类型            |
| `TO_DAYS(d)`                                                                   | 计算日期 d 距离 '0000-00-00' 的天数。[1, +$\infty$]       |
| `FROM_DAYS(n)`                                                                 | 计算从 '0000-00-00' 日开始 n 天后的日期。n > 365 时才有效 |
| `DATEDIFF(d1, d2)`                                                             | 计算两个日期之间相隔的天数                                |
| `ADDDATE(d, n)`                                                                | 计算其实日期 d 加上 n 天的日期                            |
| `ADDDATE(d, INTERVAL expr type)`, `DATE_ADD(d, INTERVAL expr type)`            | 计算起始日期 d 加上一个时间段后的日期                     |
| `SUBDATE(d, n)`                                                                | 日期 d 减去 n 天后的日期                                  |
| `SUBDATE(d,INTERVAL expr type)`                                                | 日期 d 减去 n 天后的日期                                  |
| `ADDTIME(t, n)`                                                                | 时间 t 加上 n 秒的时间                                    |
| `SUBTIME(t, n)`                                                                | 时间 t 减去 n 秒的时间                                    |
| `DATE_FORMAT(d, format)`                                                       | 按表达式 format 的要求显示日期 d                          |
| `TIME_FORMAT(t, format)`                                                       | 按表达式 format 的要求显示时间 t                          |
| `GET_FORMAT(type, s)`                                                          | 获得国家地区时间格式函数                                  |

- `ADDDATE(d, INTERVAL expr type)` 等函数中 type 和 expr 参数的关系：

    | type 值            | 预期的 expr 格式             |
    | ------------------ | ---------------------------- |
    | MICROSECOND        | MICROSECONDS                 |
    | SECOND             | SECONDS                      |
    | MINUTE             | MINUTES                      |
    | HOUR               | HOURS                        |
    | DAY                | DAYS                         |
    | WEEK               | WEEKS                        |
    | MONTH              | MONTHS                       |
    | QUARTER            | QUARTERS                     |
    | YEAR               | YEARS                        |
    | SECOND_MICROSECOND | 'SECONDS.MICROSECONDS'       |
    | MINUTE_MICROSECOND | 'MINUTES.MICROSECONDS'       |
    | MINUTE_SECOND      | 'MINUTES:SECONDS'            |
    | HOUR_MICROSECOND   | 'HOURS.MICROSECONDS'         |
    | HOUR_SECOND        | 'HOURS:MINUTES:SECONDS'      |
    | HOUR_MINUTE        | 'HOURS:MINUTES'              |
    | DAY_MICROSECOND    | 'DAYS.MICROSECONDS'          |
    | DAY_SECOND         | 'DAYS HOURS:MINUTES:SECONDS' |
    | DAY_MINUTE         | 'DAYS HOURS:MINUTES'         |
    | DAY_HOUR           | 'DAYS HOURS'                 |
    | YEAR_MONTH         | 'YEARS-MONTHS'               |
- `DATE_FORMAT(d, format)` 等函数中 format 参数的说明符

    | 说明符 | 说明                                                         |
    | ------ | ------------------------------------------------------------ |
    | %a     | 周几的缩写名称（Sun..Sat)                                    |
    | %b     | 月份的缩写名称（Jan..Dec)                                    |
    | %c     | 月份，数字形式（0..12）                                      |
    | %D     | 带英语后缀的该月日期（0th, 1st, 2nd, 3rd, ...）              |
    | %d     | 该月日期, 数字形式（00..31）                                 |
    | %e     | 该月日期, 数字形式（0..31）                                  |
    | %f     | 微秒（000000..999999）                                       |
    | %H     | 小时（00..23）                                               |
    | %h     | 小时（01..12）                                               |
    | %I     | 小时（01..12）                                               |
    | %i     | 分钟（00..59）                                               |
    | %j     | 一年中的天数（001..366）                                     |
    | %k     | 小时（0..23）                                                |
    | %l     | 小时（1..12）                                                |
    | %M     | 月份名称（January..December）                                |
    | %m     | 月份，数字形式（00..12）                                     |
    | %p     | 上午（AM）或下午（PM）                                       |
    | %r     | 时间，12 小时制 (hh:mm:ss 后加 AM 或 PM)                     |
    | %S     | 秒 (00..59)                                                  |
    | %s     | 秒（00..59）                                                 |
    | %T     | 时间，24小时制（hh:mm:ss）                                   |
    | %U     | 周（00..53），周日为每周第一天                               |
    | %u     | 周（00..53），周一为每周第一天                               |
    | %V     | 周（01..53），周日为每周第一天；和 %X 连用                   |
    | %v     | 周（01..53），周一为每周第一天；和 %x 连用                   |
    | %W     | 工作日名称（周日..周六）                                     |
    | %w     | 一周中的每日（0 = 周日..6 = 周六）                           |
    | %X     | 该周的年份，周日为每周第一天，数字形式（4 位数）；和 %V 连用 |
    | %x     | 该周的年份，周一为每周第一天，数字形式（4 位数）；和 %v 连用 |
    | %Y     | 年份，数字形式（4 位数）                                     |
    | %y     | 年份，数字形式（2 位数）                                     |
    | %%     | ‘%’ 文字字符                                                 |

# JSON 函数

| 函数                                                      | 功能                                                                                     |
| --------------------------------------------------------- | ---------------------------------------------------------------------------------------- |
| `JSON_ARRAY_APPEND(json_doc, path, val[, path, val] ...)` | 将值追加到 JSON 文档中指定数组的末尾并返回结果。                                         |
| `JSON_ARRAY_INSERT(json_doc, path, val[, path, val] ...)` | 更新 JSON 文档，插入到文档中的数组中并返回修改后的文档。                                 |
| `JSON_MERGE_PRESERVE(json_doc, json_doc[, json_doc] ...)` | 合并 JSON 文档                                                                           |
| `JSON_MERGE_PATCH(json_doc, json_doc[, json_doc] ...)`    | 执行两个或多个JSON文档的 RFC 7396 兼容合并，并返回合并后的结果，不保留具有重复键的成员。 |
| `JSON_REMOVE(json_doc, path[, path] ...)`                 | 从 JSON 文档中删除数据并返回结果。                                                       |
| `JSON_REPLACE(json_doc, path, val[, path, val] ...)`      | 替换 JSON 文档中的现有值并返回结果                                                       |
| `JSON_SET(json_doc, path, val[, path, val] ...)`          | 在 JSON 文档中插入或更新数据并返回结果                                                   |
| `JSON_UNQUOTE(json_val)`                                  | 取消 JSON 值的引号，并以 utf8mb4 字符串的形式返回结果                                    |
- 如果 json_doc 参数不是有效的 JSON 文档，或者任何路径参数不是有效的路径表达式，或者是 `$`，或者包含 `*` 或 `**` 通配符，就会发生错误。


# 条件判断函数

| 函数                      | 功能                                                           |
| ------------------------- | -------------------------------------------------------------- |
| `ISNULL(expr)`            | 如果 expr 的值为 `NULL`，返回 1，否则返回 0                    |
| `IF(expr1, expr2, expr3)` | 如果 expr1 的值为 true，返回 expr2 的值，否则返回 expr3 的值   |
| `IFNULL(expr1, expr2)`    | 如果 expr1 的值为 `NULL`，返回 expr2 的值，否则返回 expr1 的值 |
| `NULLIF(expr1, expr1)`    | 如果 expr1 = expr2，返回 `NULL`，否则返回 expr1 的值           |

# 系统信息函数

| 函数                                                          | 功能                             |
| ------------------------------------------------------------- | -------------------------------- |
| `VERSION()`                                                   | 返回数据库的版本号               |
| `CONNECTION_ID()`                                             | 返回服务器的连接数               |
| `DATABASE()`, `SCHEMA()`                                      | 返回当前数据库名                 |
| `USER()`, `SYSTEM_USER()`, `SESSION_USER()`, `CURRENT_USER()` | 返回当前用户                     |
| `CHARSET(s)`                                                  | 返回字符串 s 的字符集            |
| `COLLATION(s)`                                                | 返回字符串 s 的字符排列方式      |
| `LAST_INSERT_ID()`                                            | 返回最近生成的 AUTO_INCREMENT 值 |

# 加密函数

| 函数           | 功能                                                          |
| -------------- | ------------------------------------------------------------- |
| `MD5(s)`       | 对字符串 s 进行散列，可以用于一些普通的不需要解密的数据加密   |
| `ENCODE(s, p)` | 使用加密密码 p 加密字符串 s，结果是二进制数，保存为 BLOB 类型 |
| `DECODE(c, p)` | 使用加密密码 p 来解密密文 c                                   |

# 格式化函数

| 函数         | 功能                                            |
| ------------ | ----------------------------------------------- |
| FORMAT(x, n) | 将数字 x 进行格式化，将 x 保留到小数点后 n 位。 |

# 改变字符集的函数

| 函数                  | 功能                 |
| --------------------- | -------------------- |
| `CONVERT(s USING cs)` | 将 s 的字符集改为 cs |

# 转换数据类型

| 函数                | 功能                  |
| ------------------- | --------------------- |
| `CAST(x AS type`)   | 将 x 转换为 type 类型 |
| `CONVERT(x, type`） | 将 x 转换为 type 类型 |
type 取值：
- BINARY
- CHAR
- DATE
- DATETIME
- TIME
- SIGNED INTEGER
- UNSIGNED INTEGER
- JSON

# 加锁函数和解锁函数

| 函数                  | 说明                                                                                                                         |
| --------------------- | ---------------------------------------------------------------------------------------------------------------------------- |
| `GET_LOCK(name,time)` | 函数定义一个名称为 name、持续时间长度为 time 秒的锁。如果锁定成功，则返回 1；如果尝试超时，则返回 0；如果遇到错误，返回 NULL |
| `RELEASE_LOCK(name)`  | 函数解除名称为 name 的锁。如果解锁成功，则返回 1；如果尝试超时，返回 0 了如果解锁失败，返回 NULL                             |
| `IS_FREE_LOCK(name)`  | 函数判断是否已使用名为 name 的锁定。如果使用，返回 0，否则，返回 1                                                           |

# 重复执行指定操作的函数

| 函数                     | 功能                                                                                               |
| ------------------------ | -------------------------------------------------------------------------------------------------- |
| `BENCHMARK(count, expr)` | 函数将表达式 expr 重复执行 count 次，然后返回执行时间。该函数可以用来判断 MySQL 处理表达式的速度。 |